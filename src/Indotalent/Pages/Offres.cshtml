@page
@model Indotalent.Pages.OffresModel
@{
}


@* <!-- Facts Start -->
@await Html.PartialAsync("__FactCounter") *@
<!-- Facts Start -->
<!-- Service Start -->
@* @await Html.PartialAsync("__Offres") *@
<!-- Styles -->
<style>
    /* Maison Button */
    .maison-btn {
        width: 500px;
        height: 130px; /* Increased height */
        border: 1px solid #ddd;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        font-size: 18px;
        color: #333;
        transition: transform 0.3s, box-shadow 0.3s;
    }

        .maison-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 10px rgba(0, 0, 0, 0.15);
        }

    .maison-icon {
        font-size: 40px;
        color: #00aaff;
    }

    .maison-text {
        font-weight: bold;
        margin-top: 10px;
    }

    /* Styled Box */
    .styled-box {
        background-color: #f8f9fa;
        border: 1px solid #ddd;
        border-radius: 8px;
        padding: 20px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    /* Slider */
    .slider-container .slider {
        width: 60%;
    }

    .slider-labels {
        display: flex;
        justify-content: space-between;
        width: 60%;
        margin: 0 auto;
        font-weight: bold;
        font-size: 14px;
    }

    .slider-output {
        font-weight: bold;
        font-size: 18px;
        color: #333;
    }

    /* Choice Buttons */
    .choice-button {
        width: 250px;
        text-align: center;
        font-size: 16px;
        padding: 10px;
        border-radius: 8px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        margin: 5px 0;
        transition: all 0.3s ease;
    }

        .choice-button:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15);
        }

    /* Final Step Box */
    .final-box {
        background-color: #007bff;
        color: white;
        padding: 20px;
        border-radius: 8px;
        font-size: 18px;
        font-weight: bold;
        width: 90%;
        max-width: 500px;
        margin: 0 auto;
    }

    /* New Project Details Box */
    .project-details-box {
        /* background-color: #f4f4f4; */
        background-color: #007bff;
        border: 1px solid #ddd;
        border-radius: 8px;
        padding: 20px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        text-align: left;
        width: 90%;
        max-width: 500px;
        margin: 0 auto;
    }

        .project-details-box h5 {
            font-size: 20px;
            font-weight: bold;
        }

        .project-details-box ul {
            margin-left: 20px;
            list-style-type: disc;
            color: white;
        }

        .project-details-box p {
            font-size: 18px;
            font-weight: bold;
            /* color: #007bff; */
            color: white;
            margin-top: 15px;
        }

    /* Retour Button */
    .retour-btn {
        font-size: 16px;
        padding: 10px 20px;
        border-radius: 8px;
    }

    /* Appartment Button */
    .appartment-btn {
        width: 500px;
        height: 130px;
        border: 1px solid #ddd;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        font-size: 18px;
        color: #333;
        transition: transform 0.3s, box-shadow 0.3s;
    }

        .appartment-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 10px rgba(0, 0, 0, 0.15);
        }

    .appartment-icon {
        font-size: 40px;
        color: #00aaff;
    }

    .appartment-text {
        font-weight: bold;
        margin-top: 10px;
    }

    /* Entreprise Button */
    .entreprise-btn {
        width: 500px;
        height: 130px;
        border: 1px solid #ddd;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        font-size: 18px;
        color: #333;
        transition: transform 0.3s, box-shadow 0.3s;
    }

        .entreprise-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 10px rgba(0, 0, 0, 0.15);
        }

    .entreprise-icon {
        font-size: 40px;
        color: #00aaff;
    }

    .entreprise-text {
        font-weight: bold;
        margin-top: 10px;
    }

    .solution-container, .distance-container {
        background-color: #f8f9fa;
        border: 1px solid #ddd;
        border-radius: 8px;
        padding: 20px;
        max-width: 600px;
        margin: 0 auto;
        text-align: center;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .solution-box {
        border: 1px solid #ccc;
        border-radius: 8px;
        padding: 15px;
        margin: 10px 0;
        background-color: #f1f1f1;
        text-align: left;
        cursor: pointer;
    }

        .solution-box:hover {
            background-color: #e0e0e0;
        }

        .solution-box.selected {
            background-color: #007bff;
            color: white;
        }

    .solution-title {
        font-weight: bold;
        font-size: 18px;
    }

    .solution-description {
        margin-top: 5px;
        font-size: 14px;
    }

    .solution-buttons {
        margin-top: 20px;
    }

        .solution-buttons .btn {
            margin: 5px;
            width: 120px;
        }

    .form-group {
        margin-bottom: 20px;
        text-align: left;
    }

        .form-group label {
            font-weight: bold;
        }

    #appartmentSolution {
        margin-bottom: 20px;
    }

    .final-box {
        background-color: #007BFF;
        color: white;
        padding: 20px;
        border-radius: 8px;
        width: 100%;
        max-width: 500px;
        margin: 0 auto;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    #finalAmount {
        font-size: 24px;
        font-weight: bold;
        margin-top: 10px;
    }

    #finalOffer {
        margin-top: 10px;
        font-size: 18px;
        color: #ffffff;
        font-weight: bold;
    }

</style>

<div class="container-fluid py-5">
    <div class="container py-5">
        <!-- Section Title -->
        <div class="section-title text-center position-relative pb-3 mb-5 mx-auto" style="max-width: 600px;">
            <h5 class="fw-bold text-primary text-uppercase">Faites-nous confiance !</h5>
            <h1 class="mb-0">Rejoignez la révolution électrique avec VECO Avempace</h1>
        </div>

        <!-- Maison Button (Centered) -->
        <div class="d-flex justify-content-center mb-5">
            <button id="maisonButton" class="btn btn-light text-center shadow-lg rounded maison-btn" onclick="showStep2()">
                <div class="maison-icon">
                    <i class="bi bi-house-door-fill"></i>
                </div>
                <div class="maison-text">Maison</div>
            </button>
        </div>

        <!-- Appartement Button (Centered) -->
        <div class="d-flex justify-content-center mb-5">
            <button id="appartmentButton" class="btn btn-light text-center shadow-lg rounded appartment-btn" onclick="showAppartmentSolution()">
                <div class="appartment-icon">
                    <i class="bi bi-building"></i>
                </div>
                <div class="appartment-text">Appartement</div>
            </button>
        </div>

        <div class="d-flex justify-content-center mb-5">
            <button id="entrepriseButton" class="btn btn-light text-center shadow-lg rounded entreprise-btn" onclick="showForm()">
                <div class="entreprise-icon">
                    <i class="bi bi-building"></i>
                </div>
                <div class="entreprise-text">Entreprise</div>
            </button>
        </div>

        <!-- Appartment Solution Section -->
        <div id="appartmentSolution" class="solution-container section-margin" style="display: none;">
            <h5 class="text-center">Vous recherchez une solution de recharge</h5>
            <div class="solution-box collective" onclick="selectSolution('Collective')">
                <div class="solution-title">Collective</div>
                <div class="solution-description">
                    Solution à moindre coût grâce à la mutualisation des installations avec d'autres copropriétaires
                </div>
            </div>

            <div class="solution-box individuelle" onclick="selectSolution('Individuelle')">
                <div class="solution-title">Individuelle</div>
                <div class="solution-description">
                    Infrastructure individuelle
                </div>
            </div>

            <div class="solution-buttons text-center">
                <button class="btn btn-outline-primary" onclick="goBack()">Retour</button>
                <button id="nextButton" class="btn btn-primary" onclick="goToNext()">Suivant</button>
            </div>
        </div>

        <!-- Distance Estimation Section (Initially Hidden) -->
        <div id="distanceEstimation" class="distance-container section-margin" style="display: none;">
            <h5 class="text-center">Etage de mon appartement</h5>
            <div class="form-group">
                <label for="appartmentFloor">Etage de mon appartement</label>
                <select id="appartmentFloor" class="form-control">
                    <option>--Veuillez sélectionner votre choix--</option>
                </select>
            </div>
        </div>

        <!-- Dynamic Recommendation Section -->
        <div id="dynamicRecommendation" style="display: none; margin-top: 50px; text-align: center;">
            <h5 id="dynamicRecommendationText">Je veux pouvoir piloter et suivre précisément la consommation d'électricité liée à ma recharge (borne connectée)</h5>
            <div class="choices mt-3">
                <button class="btn btn-primary choice-button" onclick="handleChoice2('yes')">Oui, (recommandé)</button>
                <button class="btn btn-primary choice-button" onclick="handleChoice2('no')">Non</button>
            </div>

            <div id="blueBox" style="display: none; margin-top: 20px; text-align: center;">
                <div class="final-box">
                    <span id="blueBoxText">Votre projet à partir de :</span>
                    <div id="finalAmountText" style="font-size: 24px; font-weight: bold; margin-top: 10px;"></div>
                    <div id="finalOfferText" style="margin-top: 10px; font-size: 18px; color: #ffffff; font-weight: bold;"></div>
                    <div id="additionalText" style="margin-top: 10px; font-size: 16px; color: #ffffff;"></div>
                </div>
            </div>
        </div>

        <!-- Styled Box for Slider Section -->
        <div id="step2Content" class="styled-box" style="display: none; margin-top: 80px;">
            <h5 class="text-center mb-4">La distance entre le tableau électrique et le point de charge sera de (en mètres)...</h5>
            <div class="slider-container text-center">
                <input type="range"
                       id="distanceSlider"
                       min="0"
                       max="3"
                       value="0"
                       step="1"
                       class="slider"
                       oninput="updateSliderLabel(this.value)"
                       onchange="displayRecommendation(this.value)" />
                <div class="slider-labels mt-3">
                    <span></span>
                    <span>- 10m</span>
                    <span>10m &lt; d &lt; 20m</span>
                    <span>+ 20m</span>
                </div>
                <div id="sliderOutput" class="slider-output mt-4"></div>
            </div>
        </div>

        <!-- Choices Section -->
        <div id="choiceSection" class="styled-box" style="display: none; margin-top: 30px; text-align: center;">
            <h5>Je veux pouvoir piloter et suivre précisément la consommation d'électricité liée à ma recharge (borne connectée)</h5>
            <div class="choices mt-3">
                <button class="btn btn-primary choice-button" onclick="handleChoice('yes')">Oui, (recommandé)</button>
                <button class="btn btn-primary choice-button" onclick="handleChoice('no')">Non</button>
            </div>
        </div>

        <!-- Recommendation Section -->
        <div id="recommendation" style="display: none; margin-top: 50px; text-align: center;">
            <h5 id="recommendationText">Je veux pouvoir piloter et suivre précisément la consommation d'électricité liée à ma recharge (borne connectée)</h5>
            <div class="choices mt-3">
                <button class="btn btn-primary choice-button" onclick="handleChoice('yes')">Oui, (recommandé)</button>
                <button class="btn btn-primary choice-button" onclick="handleChoice('no')">Non</button>
            </div>
        </div>

        <!-- Maison Sections -->
        <div class="d-flex justify-content-between align-items-start mt-4">
            <!-- Left Box (Maison) -->
            <div class="mx-2">
                <div id="finalStepBoxLeft" class="final-box" style="display: none;">
                    <span id="finalStepTextLeft">Votre projet à partir de :</span>
                    <div id="finalAmountLeft" style="font-size: 24px; font-weight: bold; margin-top: 10px;"></div>
                    <div id="finalOfferLeft" style="margin-top: 10px; font-size: 18px; color: #ffffff; font-weight: bold;"></div>
                </div>
                <div id="projectDetailsLeft" class="project-details-box mt-3" style="display: none;"></div>
            </div>

            <!-- Middle Box (Maison) -->
            <div class="mx-2">
                <div id="finalStepBox" class="final-box" style="display: none;">
                    <span id="finalStepText">Votre projet à partir de :</span>
                    <div id="finalAmount" style="font-size: 24px; font-weight: bold; margin-top: 10px;"></div>
                    <div id="finalOffer" style="margin-top: 10px; font-size: 18px; color: #ffffff; font-weight: bold;"></div>
                </div>
                <div id="projectDetails" class="project-details-box mt-3" style="display: none;"></div>
            </div>

            <!-- Right Box (Maison) -->
            <div class="mx-2">
                <div id="finalStepBoxRight" class="final-box" style="display: none;">
                    <span id="finalStepTextRight">Votre projet à partir de :</span>
                    <div id="finalAmountRight" style="font-size: 24px; font-weight: bold; margin-top: 10px;"></div>
                    <div id="finalOfferRight" style="margin-top: 10px; font-size: 18px; color: #ffffff; font-weight: bold;"></div>
                </div>
                <div id="projectDetailsRight" class="project-details-box mt-3" style="display: none;color: #ffffff;"></div>
            </div>
        </div>

        <!-- Appartement Sections -->
        <div class="d-flex justify-content-between align-items-start mt-4">
            <!-- Left Box (Appartement) -->
            <div class="mx-2">
                <div id="finalStepBoxLeftAppartement" class="final-box" style="display: none;">
                    <span id="finalStepTextLeftAppartement">Votre projet à partir de :</span>
                    <div id="finalAmountLeftAppartement" style="font-size: 24px; font-weight: bold; margin-top: 10px;"></div>
                    <div id="finalOfferLeftAppartement" style="margin-top: 10px; font-size: 18px; color: #ffffff; font-weight: bold;"></div>
                </div>
                <div id="projectDetailsLeftAppartement" class="project-details-box mt-3" style="display: none;"></div>
            </div>

            <!-- Middle Box (Appartement) -->
            <div class="mx-2">
                <div id="finalStepBoxAppartement" class="final-box" style="display: none;">
                    <span id="finalStepTextAppartement">Votre projet à partir de :</span>
                    <div id="finalAmountAppartement" style="font-size: 24px; font-weight: bold; margin-top: 10px;"></div>
                    <div id="finalOfferAppartement" style="margin-top: 10px; font-size: 18px; color: #ffffff; font-weight: bold;"></div>
                </div>
                <div id="projectDetailsAppartement" class="project-details-box mt-3" style="display: none;"></div>
            </div>

            <!-- Right Box (Appartement) -->
            <div class="mx-2">
                <div id="finalStepBoxRightAppartement" class="final-box" style="display: none;">
                    <span id="finalStepTextRightAppartement">Votre projet à partir de :</span>
                    <div id="finalAmountRightAppartement" style="font-size: 24px; font-weight: bold; margin-top: 10px;"></div>
                    <div id="finalOfferRightAppartement" style="margin-top: 10px; font-size: 18px; color: #ffffff; font-weight: bold;"></div>
                </div>
                <div id="projectDetailsRightAppartement" class="project-details-box mt-3" style="display: none;"></div>
            </div>
        </div>

        <!-- Contact -->
        <div id="contactblockid" style="display: none; margin-top: 20px; text-align: center;">
            <div class="col-lg-6 offset-lg-3 wow slideInUp" data-wow-delay="0.3s">
                <form id="clients_form">
                    <div class="row g-3">
                        @Html.AntiForgeryToken()
                        <input type="hidden" asp-for="Input.Id" class="ignore" />
                        <input type="hidden" asp-for="Input.TypeWF" class="ignore" />
                        <input type="hidden" asp-for="Input.Distance" class="ignore" />
                        <input type="hidden" asp-for="Input.IsConsumptionMonitoring" class="ignore" />
                        <div class="col-md-6">
                            <input type="text" asp-for="Input.Nom" class="form-control border-0 bg-light px-4" placeholder="Nom & Prénom" style="height: 55px;">
                        </div>
                        <div class="col-md-6">
                            <input type="email" asp-for="Input.Email" class="form-control border-0 bg-light px-4" placeholder="Adresse électronique" style="height: 55px;">
                        </div>
                        <div class="col-md-6">
                            <input type="tel" asp-for="Input.Tel" class="form-control border-0 bg-light px-4" placeholder="Téléphone" style="height: 55px;">
                        </div>
                        <div class="col-12">
                            <input type="text" asp-for="Input.Sujet" class="form-control border-0 bg-light px-4" placeholder="Sujet" style="height: 55px;">
                        </div>
                        <div class="col-12">
                            <input type="text" asp-for="Input.Adresse" class="form-control border-0 bg-light px-4" placeholder="Adresse" style="height: 55px;">
                        </div>
                        <div class="col-12">
                            <textarea asp-for="Input.Message" class="form-control border-0 bg-light px-4 py-3" rows="4" placeholder="Message"></textarea>
                        </div>
                        <div class="col-12">
                            <button class="btn btn-primary w-100 py-3" type="submit" id="submitButton">Envoyer</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <!-- Retour Button -->
    <div class="text-center mt-5">
        <button class="btn btn-outline-primary retour-btn" onclick="goBack()">Retour</button>
    </div>
</div>

<!-- Service End -->
<!-- Vendor Start -->
@await Html.PartialAsync("__Vendor")
<!-- Vendor End -->

<script>
        let selectedDistance = 0;
        let appartmentFloor = null;

        const formattedProjectDetails = `
    <p>Une solution pratique et économique, idéale pour les particuliers ou petites entreprises recherchant une borne de recharge simple, fiable et performante.</p>
    <br><br><br>
    <p>Principales fonctionnalités :</p>
    <ul style="list-style-type: disc; margin-left:20px;">
      <li>Puissance maximale 7,4kW monophasé</li>
      <li>Gestion via application mobile</li>
      <li>Connectivité Bluetooth/WiFi</li>
      <li>Compatibilité avec les panneaux photovoltaïques</li>
      <li>Classe de protection IP55</li>
    </ul>
    `;

        function showStep2() {
            document.getElementById("step2Content").style.display = "block";
            document.getElementById("appartmentButton").style.display = "none";
            document.getElementById("entrepriseButton").style.display = "none";

            $('#Input_TypeWF').val("1");
            const slider = document.getElementById("distanceSlider");
            slider.value = 0;
            updateSliderLabel(0);
        }

        function updateSliderLabel(value) {
            selectedDistance = value;
            const output = document.getElementById("sliderOutput");

            if (value == 0) {
                output.innerText = "";
            } else if (value == 1) {
                output.innerText = "- 10m";
                $('#Input_Distance').val("- 10m");
            } else if (value == 2) {
                output.innerText = "10m < d < 20m";
                $('#Input_Distance').val("10m < d < 20m");
            } else if (value == 3) {
                output.innerText = "+ 20m";
                $('#Input_Distance').val("+ 20m");
            }
        }

        function displayRecommendation(value) {
            const finalStepBox = document.getElementById("finalStepBox");
            const finalStepBoxRight = document.getElementById("finalStepBoxRight");
            const finalStepBoxLeft = document.getElementById("finalStepBoxLeft");
            const projectDetailsRight = document.getElementById("projectDetailsRight");
            const projectDetailsLeft = document.getElementById("projectDetailsLeft");
            const projectDetails = document.getElementById("projectDetails");

            // Hide these sections to reset the view
            finalStepBox.style.display = "none";
            finalStepBoxRight.style.display = "none";
            finalStepBoxLeft.style.display = "none";
            projectDetailsRight.style.display = "none";
            projectDetailsLeft.style.display = "none";
            projectDetails.style.display = "none";

            // Show the choiceSection if value > 0
            if (value > 0) {
                document.getElementById("choiceSection").style.display = "block";
            } else {
                document.getElementById("choiceSection").style.display = "none";
            }
        }

        function handleChoice(choice) {
            const finalStepBoxes = [
                document.getElementById("finalStepBox"),
                document.getElementById("finalStepBoxLeft"),
                document.getElementById("finalStepBoxRight")
            ];

            const finalStepTexts = [
                document.getElementById("finalStepText"),
                document.getElementById("finalStepTextLeft"),
                document.getElementById("finalStepTextRight")
            ];

            const finalOffers = [
                document.getElementById("finalOffer"),
                document.getElementById("finalOfferLeft"),
                document.getElementById("finalOfferRight")
            ];

            const finalAmounts = [
                document.getElementById("finalAmount"),
                document.getElementById("finalAmountLeft"),
                document.getElementById("finalAmountRight")
            ];

            const projectDetailsSections = [
                document.getElementById("projectDetails"),
                document.getElementById("projectDetailsLeft"),
                document.getElementById("projectDetailsRight")
            ];

            let smartAmount, essentielAmount, premiumAmount;

            // Example distances logic (as before)
            if (selectedDistance == 1) {
                smartAmount = "12 490MAD";
                essentielAmount = "9 990MAD";
                premiumAmount = "13 490MAD";
            } else if (selectedDistance == 2) {
                smartAmount = "12 790MAD";
                essentielAmount = "10 290MAD";
                premiumAmount = "13 790MAD";
            } else if (selectedDistance == 3) {
                smartAmount = "13 090MAD";
                essentielAmount = "10 490MAD";
                premiumAmount = "14 090MAD";
            }

            const forfaitText = (choice === "yes") ? "<br>+ Forfaits sérénité dès 59,90 MAD/Mois" : "";

            // Center the text by wrapping in a <div style="text-align:center;">
            finalStepTexts[0].innerHTML = `<div style="text-align:center;">Offre Smart<br>À partir de ${smartAmount}${forfaitText}</div>`;
            finalStepTexts[1].innerHTML = `<div style="text-align:center;">Offre Essentiel<br>À partir de ${essentielAmount}${forfaitText}</div>`;
            finalStepTexts[2].innerHTML = `<div style="text-align:center;">Offre Premium<br>À partir de ${premiumAmount}${forfaitText}</div>`;

            // Clear old amounts/offers since we included everything in innerHTML
            finalAmounts[0].innerText = "";
            finalAmounts[1].innerText = "";
            finalAmounts[2].innerText = "";

            finalOffers[0].innerText = "";
            finalOffers[1].innerText = "";
            finalOffers[2].innerText = "";

            // Show all boxes and project details
            for (let i = 0; i < 3; i++) {
                finalStepBoxes[i].style.display = "block";
                projectDetailsSections[i].style.display = "block";
                projectDetailsSections[i].innerHTML = formattedProjectDetails;
            }

            document.getElementById("contactblockid").style.display = "block";
            $('#Input_IsConsumptionMonitoring').val(choice === "yes" ? "Oui" : "Non");
        }

        function showForm() {
            const contactblockid = document.getElementById("contactblockid");
            document.getElementById("maisonButton").style.display = "none";
            document.getElementById("appartmentButton").style.display = "none";

            $('#Input_TypeWF').val("3");
            contactblockid.style.display = "block";
        }

        function goBack() {
            document.getElementById("maisonButton").style.display = "block";
            document.getElementById("appartmentButton").style.display = "block";
            document.getElementById("entrepriseButton").style.display = "block";

            let sections = [
                "appartmentSolution",
                "distanceEstimation",
                "dynamicRecommendation",
                "step2Content",
                "choiceSection",
                "recommendation",
                "finalStepBox",
                "projectDetails",
                "contactblockid",
                "blueBox",
                "finalStepBoxRight",
                "finalStepBoxLeft",
                "projectDetailsRight",
                "projectDetailsLeft",
                "finalStepBoxAppartement",
                "finalStepBoxLeftAppartement",
                "finalStepBoxRightAppartement",
                "projectDetailsAppartement",
                "projectDetailsLeftAppartement",
                "projectDetailsRightAppartement"
            ];

            sections.forEach(function (id) {
                let section = document.getElementById(id);
                if (section) {
                    section.style.display = "none";
                }
            });
        }

        function showAppartmentSolution() {
            document.getElementById("appartmentSolution").style.display = "block";
            document.getElementById("maisonButton").style.display = "none";
            document.getElementById("entrepriseButton").style.display = "none";

            $('#Input_TypeWF').val("2");
        }

        let selectedSolution = null;
        function selectSolution(solution) {
            selectedSolution = solution;
            document.querySelectorAll('.solution-box').forEach((box) => {
                box.classList.remove('selected');
            });
            document.querySelector(`.solution-box.${solution.toLowerCase()}`).classList.add('selected');
        }

        function goToNext() {
            document.getElementById("appartmentSolution").style.display = "block";
            document.getElementById("distanceEstimation").style.display = "block";
            populateSelectOptions("appartmentFloor", 0, 10);
        }

        document.getElementById("appartmentFloor").addEventListener("change", function() {
            appartmentFloor = parseInt(this.value);
            checkAndShowRecommendation();
        });

        function checkAndShowRecommendation() {
            if (appartmentFloor !== null) {
                const dynamicRecommendation = document.getElementById("dynamicRecommendation");
                dynamicRecommendation.style.display = "block";
            }
        }

        function handleChoice2(choice) {
            const finalStepBoxes = [
                document.getElementById("finalStepBoxAppartement"),
                document.getElementById("finalStepBoxLeftAppartement"),
                document.getElementById("finalStepBoxRightAppartement")
            ];

            const finalStepTexts = [
                document.getElementById("finalStepTextAppartement"),
                document.getElementById("finalStepTextLeftAppartement"),
                document.getElementById("finalStepTextRightAppartement")
            ];

            const finalAmounts = [
                document.getElementById("finalAmountAppartement"),
                document.getElementById("finalAmountLeftAppartement"),
                document.getElementById("finalAmountRightAppartement")
            ];

            const finalOffers = [
                document.getElementById("finalOfferAppartement"),
                document.getElementById("finalOfferLeftAppartement"),
                document.getElementById("finalOfferRightAppartement")
            ];

            const projectDetailsSections = [
                document.getElementById("projectDetailsAppartement"),
                document.getElementById("projectDetailsLeftAppartement"),
                document.getElementById("projectDetailsRightAppartement")
            ];

            const essentielAmount = (9490 + (300 * appartmentFloor)) + "MAD";
            const smartAmount = (12090 + (300 * appartmentFloor)) + "MAD";
            const premiumAmount = (13090 + (300 * appartmentFloor)) + "MAD";

            const forfaitText = (choice === "yes") ? "<br>+ Forfaits sérénité dès 59,90 MAD/Mois" : "";

            finalStepTexts[0].innerHTML = `<div style="text-align:center;">Offre Smart<br>À partir de ${smartAmount}${forfaitText}</div>`;
            finalStepTexts[1].innerHTML = `<div style="text-align:center;">Offre Essentiel<br>À partir de ${essentielAmount}${forfaitText}</div>`;
            finalStepTexts[2].innerHTML = `<div style="text-align:center;">Offre Premium<br>À partir de ${premiumAmount}${forfaitText}</div>`;

            // Clear old amounts/offers
            finalAmounts[0].innerText = "";
            finalAmounts[1].innerText = "";
            finalAmounts[2].innerText = "";

            finalOffers[0].innerText = "";
            finalOffers[1].innerText = "";
            finalOffers[2].innerText = "";

            for (let i = 0; i < 3; i++) {
                finalStepBoxes[i].style.display = "block";
                projectDetailsSections[i].style.display = "block";
                projectDetailsSections[i].innerHTML = formattedProjectDetails;
            }

            document.getElementById("contactblockid").style.display = "block";
            $('#Input_IsConsumptionMonitoring').val(choice === "yes" ? "Oui" : "Non");
        }

        function populateSelectOptions(selectId, start, end) {
            const select = document.getElementById(selectId);
            select.innerHTML = '<option>--Veuillez sélectionner votre choix--</option>';
            for (let i = start; i <= end; i++) {
                const option = document.createElement("option");
                option.value = i;
                option.textContent = i;
                select.appendChild(option);
            }
        }

        document.getElementById("appartmentFloor").addEventListener("change", hideSectionsOnSelectChange);

        function hideSectionsOnSelectChange() {
            const sectionsToHide = [
                "projectDetails",
                "blueBox",
                "finalStepBox",
                "finalStepBoxRight",
                "finalStepBoxLeft",
                "projectDetailsRight",
                "projectDetailsLeft",
                "finalStepBoxAppartement",
                "finalStepBoxRightAppartement",
                "finalStepBoxLeftAppartement",
                "projectDetailsRightAppartement",
                "projectDetailsLeftAppartement",
                "projectDetailsAppartement"
            ];

            sectionsToHide.forEach(function (id) {
                let element = document.getElementById(id);
                if (element) {
                    element.style.display = "none";
                }
            });
        }
</script>

<link rel="stylesheet" media="screen, print" href="~/css/notifications/toastr/toastr.min.css" />
<script type="text/javascript" src="~/lib/jquery/dist/jquery-3.4.1.min.js" asp-append-version="true"></script>
<script type="text/javascript" src="~/lib/axios/dist/axios.min.js" asp-append-version="true"></script>
<script type="text/javascript" src="~/js/notifications/toastr/toastr.min.js" asp-append-version="true"></script>

<script type="text/javascript">
    $('#clients_form #submitButton').click(function (e) {
        const request = $('#clients_form').serialize();
        const type = $('#Input_TypeWF').val();
        const distance = $('#Input_Distance').val();
        const isConsumptionMonitoring = $('#Input_IsConsumptionMonitoring').val();
        axios.post('@Url.Page("/Offres")?type=' + type + '&distance=' + distance + '&isConsumptionMonitoring=' + isConsumptionMonitoring, request).then(res => {
            toastr["info"]('Message envoyé avec succès.');
        });

        event.preventDefault();
        event.stopPropagation();
    })
</script>
