@page
@model Indotalent.Pages.NetworkDetailsModel

<!-- Slick -->
<link rel="stylesheet" href="~/css/slick.css" />
<link rel="stylesheet" href="~/css/slick-theme.css" />

<!-- style.css -->
<link rel="stylesheet" href="~/css/style.css" />

<!-- Font Awesome -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

<style>
    .network-details-container {
        max-width: 700px;
        margin: 40px auto;
    }

    /* Header row: back arrow, title, "Add charging station" button */
    .details-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 20px;
    }

    .back-arrow {
        font-size: 1.2rem;
        cursor: pointer;
    }

    .network-title {
        font-size: 1.3rem;
        font-weight: bold;
        margin: 0 10px;
    }

    .btn-add-charging {
        background-color: #0052cc;
        color: #fff;
        border-radius: 20px;
        padding: 5px 15px;
        border: none;
        font-size: 0.9rem;
    }

    /* Tab bar (Chargers, Sessions, etc.) */
    .tab-bar {
        display: flex;
        margin-bottom: 20px;
        border-bottom: 2px solid #eee;
    }

    .tab-item {
        margin-right: 30px;
        padding-bottom: 10px;
        cursor: pointer;
        font-weight: 500;
        color: #888;
    }

        .tab-item.active {
            color: #0052cc;
            border-bottom: 2px solid #0052cc;
        }

    /* "Add charger" block */
    .add-charger-card {
        background-color: #f2f2f2;
        border-radius: 8px;
        padding: 20px;
        text-align: center;
        margin-bottom: 20px;
    }

        .add-charger-card h5 {
            margin-bottom: 10px;
        }

        .add-charger-card p {
            margin-bottom: 15px;
            color: #666;
        }

    .add-charger-btn {
        border: none;
        background: none;
        font-size: 3rem;
        cursor: pointer;
    }

    .section {
        margin-top: 80px; /* Adjust as needed */
    }

    /* Style for listing charging stations (Chargers tab) */
    .station-list-container {
        margin-top: 20px;
    }

    .station-card {
        background-color: #f9f9f9;
        border-radius: 8px;
        padding: 20px;
        margin-bottom: 20px;
        transition: box-shadow 0.2s;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 8px;
        text-align: center;
        cursor: pointer;
    }

        .station-card:hover {
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }

    .station-name {
        font-size: 1.2rem;
        font-weight: bold;
        color: #333;
    }

    .station-status {
        color: #666;
        font-size: 0.95rem;
    }

    .station-power {
        color: #666;
        font-size: 0.95rem;
    }

    /* Sessions table styling */
    .sessions-table-container {
        margin-top: 20px;
    }

        .sessions-table-container h5 {
            margin-bottom: 10px;
        }

    .table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 20px;
    }

        .table th,
        .table td {
            text-align: left;
            padding: 8px 12px;
            border-bottom: 1px solid #eee;
        }

        .table th {
            background-color: #f9f9f9;
            font-weight: 600;
        }
</style>

<div class="section">
    <div class="container">
        <div class="network-details-container">

            <!-- Top row: back arrow, network name, "Add charging station" button -->
            <div class="details-header">
                <i class="fa fa-arrow-left back-arrow"
                   onclick="window.history.back()"></i>

                <div class="network-title">@Model.NetworkName</div>

                <button class="btn-add-charging"
                        onclick="window.location.href='@Url.Page("AddChargingStation")'">
                    Add charging station
                </button>
            </div>

            <!-- Tab bar -->
            <div class="tab-bar">
                <div class="tab-item @(Model.ActiveTab == "chargers" ? "active" : "")"
                     onclick="window.location.href='@Url.Page("NetworkDetails", new { networkName = Model.NetworkName, tab = "chargers" })'">
                    Chargers
                </div>
                <div class="tab-item @(Model.ActiveTab == "sessions" ? "active" : "")"
                     onclick="window.location.href='@Url.Page("NetworkDetails", new { networkName = Model.NetworkName, tab = "sessions" })'">
                    Sessions
                </div>
                <div class="tab-item @(Model.ActiveTab == "energy" ? "active" : "")"
                     onclick="window.location.href='@Url.Page("NetworkDetails", new { networkName = Model.NetworkName, tab = "energy" })'">
                    Energy
                </div>
                <div class="tab-item">Settings</div>
            </div>

            @if (Model.ActiveTab == "chargers")
            {
                <!-- CHARGERS block -->
                <div class="add-charger-card">
                    <h5>Add charging station</h5>
                    <p>Click on the button + to add a new charger</p>
                    <button class="add-charger-btn"
                            onclick="window.location.href='@Url.Page("AddChargingStation")'">
                        <i class="fa fa-plus"></i>
                    </button>
                </div>

                <div class="station-list-container">
                    @if (Model.ChargingStations != null && Model.ChargingStations.Count > 0)
                    {
                        @foreach (var station in Model.ChargingStations)
                        {
                            <div class="station-card"
                                 onclick="window.location.href='@Url.Page("ChargerStationDetails", new { name = station.ChargerName })'">
                                <span class="station-name">@station.ChargerName</span>
                                <span class="station-status">@station.Status</span>
                                <span class="station-power">@station.PowerKW</span>
                            </div>
                        }
                    }
                    else
                    {
                        <p>No charging stations found. Add one using the plus button above.</p>
                    }
                </div>
            }
            else if (Model.ActiveTab == "sessions")
            {
            <!-- SESSIONS block -->
            <div class="sessions-table-container">
                <h5>Charging Sessions</h5>
                <table class="table">
                    <thead>
                        <tr>
                            <th>DazeBox</th>
                            <th>Data</th>
                            <th>Inizio</th>
                            <th>Fine</th>
                            <th>Tempo di ricarica</th>
                            <th>kW</th>
                        </tr>
                    </thead>
                    <tbody>
                        @if (Model.Sessions != null && Model.Sessions.Count > 0)
                        {
                            @foreach (var session in Model.Sessions)
                            {
                                <tr>
                                    <td>@session.StationName</td>
                                    <td>@session.DateString</td>
                                    <td>@session.StartTimeString</td>
                                    <td>@session.EndTimeString</td>
                                    <td>@session.DurationString</td>
                                    <td>@session.kWString</td>
                                </tr>
                            }
                        }
                        else
                        {
                            <tr>
                                <td colspan="6">No sessions found.</td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
            }

            else if (Model.ActiveTab == "energy")
            {
            <div class="energy-box" style="margin-top:20px; text-align:center;">
                <h5>Delivered Energy</h5>

                <!-- Show the sum, e.g. 104.06 kWh -->
                <div style="
            display:inline-block;
            padding:20px;
            background-color:#f9f9f9;
            border-radius:8px;
            min-width:200px;">
                    <span style="font-size:1.4rem; font-weight:bold;">
                        @Model.TotalEnergy kWh
                    </span>
                </div>

                <!-- If you want to display a small text like "1d 1m 3m" under it -->
                <div style="margin-top:8px; color:#666;">
                    1d 1m 3m
                </div>
            </div>
            }

        </div>
    </div>
</div>

@await Html.PartialAsync("__Vendor")

<script src="~/js/jquery.min.js"></script>
<script src="~/js/bootstrap.min.js"></script>
<script src="~/landingpage/js/slick.min.js"></script>
